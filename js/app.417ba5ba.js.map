{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/TheBook.vue?c3bb","webpack:///./src/App.vue?1c1b","webpack:///./src/components/DropScreen.vue?7ea2","webpack:///./src/components/BookBookmark.vue?8951","webpack:///./src/components/BookParagraph.vue?61fd","webpack:///./src/components/BookHeader.vue","webpack:///./src/App.vue?4154","webpack:///./src/components/DropScreen.vue?3fe2","webpack:///./src/components/TheBook.vue?2e16","webpack:///./src/components/BookBookmark.vue?8989","webpack:///./src/components/BookBookmark.vue","webpack:///./src/components/BookBookmark.vue?426b","webpack:///./src/components/BookBookmark.vue?b7cc","webpack:///./src/components/BookParagraph.vue?0af8","webpack:///src/components/BookParagraph.vue","webpack:///./src/components/BookParagraph.vue?6fec","webpack:///./src/components/BookParagraph.vue","webpack:///src/components/BookHeader.vue","webpack:///./src/components/BookHeader.vue?59c8","webpack:///./src/components/BookLineBreak.vue?e84d","webpack:///src/components/BookLineBreak.vue","webpack:///./src/components/BookLineBreak.vue?0f48","webpack:///./src/components/BookLineBreak.vue","webpack:///./src/components/TheBook.vue","webpack:///./src/components/TheBook.vue?ebd3","webpack:///./src/components/TheBook.vue?31a3","webpack:///./src/components/DropScreen.vue","webpack:///./src/components/DropScreen.vue?4906","webpack:///./src/components/DropScreen.vue?3603","webpack:///src/App.vue","webpack:///./src/App.vue?b65f","webpack:///./src/App.vue","webpack:///./src/helpers/aozora.ts","webpack:///./src/helpers/bookmark.ts","webpack:///./src/store/book.ts","webpack:///./src/store/index.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","render","_vm","this","_h","$createElement","_c","_self","attrs","tag","staticRenderFns","staticClass","on","$event","stopPropagation","preventDefault","onFileDragover","onFileDragleave","onFileDrop","isLoaded","_e","_v","_s","title","author","_l","text","textType","index","style","extend","pxPosition","computed","left","addEventListener","e","target","id","console","log","classList","contains","startsWith","paragraphIndexMatch","match","paragraphIndex","parseInt","$store","commit","$nextTick","range","offset","textNode","document","caretPositionFromPoint","x","y","offsetNode","caretRangeFromPoint","startContainer","startOffset","nodeIndex","Array","indexOf","childNodes","bookmark","paragraph","node","character","component","paragraphId","domProps","content","props","jisageStyle","margin","jisage","headerId","createElement","hLevel","class","components","BookBookmark","BookParagraph","BookHeader","BookLineBreak","position","encoding","methods","getters","textComponents","TheBook","isDraggingFile","dataTransfer","files","file","dispatch","type","DropScreen","todo","comments","accents","replace","rubify","furigana","boutenify","bouten","kutenkara","jiskuten","midasi","midasipattern","p1","p2","BOOKMARK_CLASS","idFromBookmark","insertBookmark","template","innerHTML","bookmarkNode","textContent","sliceUntilBookmark","charAtBookmark","sliceAfterBookmark","newBookmark","appendChild","createTextNode","add","backgroundColor","bookmarkFragment","createDocumentFragment","replaceChild","BookState","bookFile","rawLines","state","actions","context","payload","Promise","resolve","reader","FileReader","onload","rawString","split","readAsText","reject","mutations","texts","divisor","metadataEnd","sagepattern","fullwidth","jisageString","String","fromCharCode","charCodeAt","owaripattern","owari","textComponent","emptyBookmark","assign","cleanTextComponent","cleanContent","namespaced","use","debug","Store","book","strict","config","productionTip","store","h","App","$mount"],"mappings":"aACE,SAASA,EAAqBC,GAQ7B,IAPA,IAMIC,EAAUC,EANVC,EAAWH,EAAK,GAChBI,EAAcJ,EAAK,GACnBK,EAAiBL,EAAK,GAIHM,EAAI,EAAGC,EAAW,GACpCD,EAAIH,EAASK,OAAQF,IACzBJ,EAAUC,EAASG,GAChBG,OAAOC,UAAUC,eAAeC,KAAKC,EAAiBX,IAAYW,EAAgBX,IACpFK,EAASO,KAAKD,EAAgBX,GAAS,IAExCW,EAAgBX,GAAW,EAE5B,IAAID,KAAYG,EACZK,OAAOC,UAAUC,eAAeC,KAAKR,EAAaH,KACpDc,EAAQd,GAAYG,EAAYH,IAG/Be,GAAqBA,EAAoBhB,GAE5C,MAAMO,EAASC,OACdD,EAASU,OAATV,GAOD,OAHAW,EAAgBJ,KAAKK,MAAMD,EAAiBb,GAAkB,IAGvDe,IAER,SAASA,IAER,IADA,IAAIC,EACIf,EAAI,EAAGA,EAAIY,EAAgBV,OAAQF,IAAK,CAG/C,IAFA,IAAIgB,EAAiBJ,EAAgBZ,GACjCiB,GAAY,EACRC,EAAI,EAAGA,EAAIF,EAAed,OAAQgB,IAAK,CAC9C,IAAIC,EAAQH,EAAeE,GACG,IAA3BX,EAAgBY,KAAcF,GAAY,GAE3CA,IACFL,EAAgBQ,OAAOpB,IAAK,GAC5Be,EAASM,EAAoBA,EAAoBC,EAAIN,EAAe,KAItE,OAAOD,EAIR,IAAIQ,EAAmB,GAKnBhB,EAAkB,CACrB,IAAO,GAGJK,EAAkB,GAGtB,SAASS,EAAoB1B,GAG5B,GAAG4B,EAAiB5B,GACnB,OAAO4B,EAAiB5B,GAAU6B,QAGnC,IAAIC,EAASF,EAAiB5B,GAAY,CACzCK,EAAGL,EACH+B,GAAG,EACHF,QAAS,IAUV,OANAf,EAAQd,GAAUW,KAAKmB,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG/DI,EAAOC,GAAI,EAGJD,EAAOD,QAKfH,EAAoBM,EAAIlB,EAGxBY,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,SAASL,EAASM,EAAMC,GAC3CV,EAAoBW,EAAER,EAASM,IAClC3B,OAAO8B,eAAeT,EAASM,EAAM,CAAEI,YAAY,EAAMC,IAAKJ,KAKhEV,EAAoBe,EAAI,SAASZ,GACX,qBAAXa,QAA0BA,OAAOC,aAC1CnC,OAAO8B,eAAeT,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DpC,OAAO8B,eAAeT,EAAS,aAAc,CAAEe,OAAO,KAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,EAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,kBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKxC,OAAOyC,OAAO,MAGvB,GAFAvB,EAAoBe,EAAEO,GACtBxC,OAAO8B,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,EAAoBQ,EAAEc,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAAStB,GAChC,IAAIM,EAASN,GAAUA,EAAOiB,WAC7B,WAAwB,OAAOjB,EAAO,YACtC,WAA8B,OAAOA,GAEtC,OADAJ,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASgB,EAAQC,GAAY,OAAO9C,OAAOC,UAAUC,eAAeC,KAAK0C,EAAQC,IAGzG5B,EAAoB6B,EAAI,GAExB,IAAIC,EAAaC,OAAO,gBAAkBA,OAAO,iBAAmB,GAChEC,EAAmBF,EAAW3C,KAAKsC,KAAKK,GAC5CA,EAAW3C,KAAOf,EAClB0D,EAAaA,EAAWG,QACxB,IAAI,IAAItD,EAAI,EAAGA,EAAImD,EAAWjD,OAAQF,IAAKP,EAAqB0D,EAAWnD,IAC3E,IAAIU,EAAsB2C,EAI1BzC,EAAgBJ,KAAK,CAAC,EAAE,kBAEjBM,K,6ECvJT,W,oCCAA,W,oCCAA,W,6DCAA,W,2GCAA,W,6CCAI,EAAQ,E,wBCARyC,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAM,CAAC,GAAK,QAAQ,CAACF,EAAG,aAAa,CAACG,IAAI,eAAe,IAC/JC,EAAkB,GCDlB,EAAS,WAAa,IAAIR,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACK,YAAY,eAAeC,GAAG,CAAC,SAAW,SAASC,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwBb,EAAIc,eAAeH,IAAS,UAAY,SAASA,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwBb,EAAIe,gBAAgBJ,IAAS,KAAO,SAASA,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwBb,EAAIgB,WAAWL,MAAW,CAACP,EAAG,MAAM,CAACK,YAAY,mBAAmB,CAAGT,EAAIiB,SAAqGjB,EAAIkB,KAA/Fd,EAAG,KAAK,CAACK,YAAY,WAAW,CAACT,EAAImB,GAAG,qDAA+DnB,EAAY,SAAEI,EAAG,WAAWJ,EAAIkB,MAAM,IACzpB,EAAkB,GCDlB,EAAS,WAAa,IAAIlB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACK,YAAY,oBAAoB,CAACL,EAAG,MAAM,CAACK,YAAY,YAAY,CAACL,EAAG,gBAAgBA,EAAG,KAAK,CAACJ,EAAImB,GAAGnB,EAAIoB,GAAGpB,EAAIqB,UAAUjB,EAAG,KAAK,CAACJ,EAAImB,GAAGnB,EAAIoB,GAAGpB,EAAIsB,WAAWtB,EAAIuB,GAAIvB,EAAkB,gBAAE,SAASwB,GAAM,OAAOpB,EAAGoB,EAAKC,SAAS,CAACpC,IAAImC,EAAKE,MAAMnB,IAAI,YAAYD,MAAM,CAAC,GAAKkB,EAAKC,SAAW,IAAMD,EAAKE,MAAM,KAAOF,SAAW,MAC1a,EAAkB,GCDlB,EAAS,WAAa,IAAIxB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACK,YAAY,qBAAqBkB,MAAO3B,EAAiB,iBAC/J,EAAkB,GCUP,SAAI4B,OAAO,CACtBtD,KAAM,eAEN,OACI,MAAO,CACHuD,WAAY,IAIpBC,SAAU,CACN,gBACI,MAAO,CACHC,KAAM9B,KAAK4B,WAAa,QAKpC,UACIjC,OAAOoC,iBAAiB,QAAUC,IAC9B,IAAIC,EAASD,EAAEC,OACf,GAAc,MAAVA,GAA+B,MAAbA,EAAOC,GAGzB,OAFAC,QAAQC,IAAI,oDACZD,QAAQC,IAAIJ,GAGhB,GAAKC,EAAOI,UAAUC,SAAS,aAA/B,CAIA,IAAKL,EAAOC,GAAGK,WAAW,iBAKtB,OAFAJ,QAAQC,IAAI,wEACZD,QAAQC,IAAIH,GAGhB,IAAIO,EAAsBP,EAAOC,GAAGO,MAAM,SAC1C,GAA2B,MAAvBD,EAGA,OAFAL,QAAQC,IAAI,4EACZD,QAAQC,IAAIH,GAGhB,IAAIS,EAAiBC,SAASH,EAAoB,IAGlDxC,KAAK4C,OAAOC,OAAO,uBACnB7C,KAAK8C,WAAU,WACX,IAAIC,EACAC,EACAC,EACJ,GAAIC,SAASC,uBACTJ,EAAQG,SAASC,uBAAuBnB,EAAEoB,EAAEpB,EAAEqB,GAC9CJ,EAAWF,EAAMO,WACjBN,EAASD,EAAMC,WACZ,KAAIE,SAASK,oBAMhB,YADApB,QAAQC,IAAI,uBAJZW,EAAQG,SAASK,oBAAoBvB,EAAEoB,EAAEpB,EAAEqB,GAC3CJ,EAAWF,EAAMS,eACjBR,EAASD,EAAMU,YAKnB,IAAIC,EAAoBC,MAAMhH,UAAUiH,QAAQ/G,KAAKoF,EAAO4B,WAAYZ,GACpEa,EAAW,CACXC,UAAWrB,EACXsB,KAAMN,EACNO,UAAWjB,GAEfhD,KAAK4C,OAAOC,OAAO,oBAAqBiB,YC/EkS,I,wBCQtVI,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,EAAAA,E,QCnBX,EAAS,WAAa,IAAInE,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACK,YAAY,2BAA2BkB,MAAO3B,EAAe,YAAEM,MAAM,CAAC,GAAKN,EAAIoE,aAAaC,SAAS,CAAC,UAAYrE,EAAIoB,GAAGpB,EAAIwB,KAAK8C,aACxO,EAAkB,GCUP,SAAI1C,OAAO,CACtBtD,KAAM,gBACNiG,MAAO,CAAC,QACRrI,KAAM,WACF,MAAO,CACHkI,YAAanE,KAAKuB,KAAKE,MAAQ,aAC/B8C,YAAa,CACTC,OAAQxE,KAAKuB,KAAKkD,OAAS,gBClB2J,ICQlM,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QCjBA,SAAI9C,OAAO,CAClB2C,MAAO,CAAC,QACRrI,KAAM,WACF,MAAO,CACHyI,SAAU,UAAY1E,KAAKuB,KAAKE,QAGxC3B,OAAQ,SAAS6E,GACb,OAAOA,EACH,IAAM3E,KAAKuB,KAAKqD,OAChB,CACIC,MAAO,CACH,QAAU,EACV,kBAAkB,GAEtBnD,MAAO,CACH8C,OAAQxE,KAAKuB,KAAKkD,OAAS,YAE/BrF,IAAKY,KAAKuB,KAAKE,OAEnBzB,KAAKuB,KAAK8C,YCtByK,IbO/L,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,I,QclBX,EAAS,WAAa,IAAItE,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,OAC/F,EAAkB,GCKP,SAAIwB,OAAO,CACtBtD,KAAM,gBACNiG,MAAO,CAAC,UCR0L,ICOlM,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,I,QCKA,SAAI3C,OAAO,CACtBtD,KAAM,UAENyG,WAAY,CACRC,aAAcA,EACdC,cAAeA,EACfC,WAAYA,EACZC,cAAeA,GAGnBjJ,KAAM,WACF,MAAO,CACHkJ,SAAU,EACVC,SAAU,cAIlBC,QAAS,GAGTxD,SAAU,CACNb,SAAU,WACN,OAAOhB,KAAK4C,OAAO0C,QAAQ,kBAE/BlE,MAAO,WACH,OAAOpB,KAAK4C,OAAO0C,QAAQ,eAE/BjE,OAAQ,WACJ,OAAOrB,KAAK4C,OAAO0C,QAAQ,gBAE/BC,eAAgB,WACZ,OAAOvF,KAAK4C,OAAO0C,QAAQ,2BCtD8S,ICQjV,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QCHA,SAAI3D,OAAO,CACtBtD,KAAM,aACNyG,WAAY,CACRU,WAGJ,OACI,MAAO,CACHC,gBAAgB,IAIxB5D,SAAU,CACN,WAAa,OAAO7B,KAAK4C,OAAO0C,QAAQ,mBAG5CD,QAAS,CACL,iBACIrF,KAAKyF,gBAAiB,GAE1B,kBACIzF,KAAKyF,gBAAiB,GAE1B,WAAWzD,GAEP,GADAhC,KAAKyF,gBAAiB,EAClBzD,EAAE0D,aACF,IAAK,IAAInJ,EAAI,EAAGA,EAAIyF,EAAE0D,aAAaC,MAAMlJ,OAAQF,IAAK,CAClD,IAAIqJ,EAAO5D,EAAE0D,aAAaC,MAAMpJ,GAChCyD,KAAK4C,OAAOiD,SAAS,CACjBC,KAAM,oBACNF,KAAMA,EACNR,SAAU,mBC/CsT,ICQpV,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QCVA,GACb/G,KAAM,MACNyG,WAAY,CACViB,eCZkL,ICQlL,G,UAAY,eACd,EACAjG,EACAS,GACA,EACA,KACA,KACA,OAIa,I,QCnBf,MAAMyF,EAAO,SAASzE,GAElB,IAAI0E,EAAW,UACXC,EAAU,QAGd,OAFA3E,EAAOA,EAAK4E,QAAQF,EAAU,IAC9B1E,EAAOA,EAAK4E,QAAQD,EAAS,IACtB3E,GAEL6E,EAAS,SAAS7E,GAIpB,IAAI8E,EAAW,8CACf,OAAO9E,EAAK4E,QAAQE,EAAU,+BAE5BC,EAAY,SAAS/E,GACvB,IAAIgF,EAAS,mBACb,OAAOhF,EAAK4E,QAAQI,EAAQ,4CAE1BC,EAAY,SAASjF,GAGvB,IAAIkF,EAAW,kDACf,OAAOlF,EAAK4E,QAAQM,EAAU,MAE5BC,EAAS,SAASnF,GACpB,IAAIoF,EAAgB,2BACpB,OAAOpF,EAAK4E,QAAQQ,GAAe,SAASlE,EAAOmE,EAAIC,GACnD,OAAOA,GACH,IAAK,IACD,MAAO,OAASD,EAAK,QACzB,IAAK,IACD,MAAO,OAASA,EAAK,QACzB,IAAK,IACD,MAAO,OAASA,EAAK,QAG7B,OADAzE,QAAQC,IAAI,yCAA2Cb,GAChD,OC9BTuF,EAAiB,WAEjBC,GAAkBjD,GACb,IAAIA,EAASC,aAAaD,EAASE,QAAQF,EAASG,YAyBzD+C,GAAiB,CAAC3C,EAAiBP,KAErC,IAAImD,EAAW/D,SAASyB,cAAc,YACtCsC,EAASC,UAAY7C,EAGrB,IAAI8C,EAAeF,EAAS5C,QAAQR,WAAWC,EAASE,MACxD,GAAoB,MAAhBmD,GAAoD,MAA5BA,EAAaC,YAErC,OADAjF,QAAQC,IAAI,qCAAqC0B,EAASE,uBACnDK,EAIX,IAAIgD,EAAqBF,EAAaC,YAAYvH,MAAM,EAAGiE,EAASG,WAChEqD,EAAiBH,EAAaC,YAAYtD,EAASG,WACnDsD,EAAqBJ,EAAaC,YAAYvH,MAAMiE,EAASG,UAAU,GAE3E,GAAsB,MAAlBqD,EAEA,OADAnF,QAAQC,IAAI,0CAA0C0B,EAASG,4BACxDI,EAGX,IAAImD,EAActE,SAASyB,cAAc,QACzC6C,EAAYC,YAAYvE,SAASwE,eAAeJ,IAEhDE,EAAYtF,GAAK6E,GAAejD,GAChC0D,EAAYnF,UAAUsF,IAAIb,GAC1BU,EAAY9F,MAAMkG,gBAAkB,MAGpC,IAAIC,EAAmB3E,SAAS4E,yBAShC,OAR0B,MAAtBT,GACAQ,EAAiBJ,YAAYvE,SAASwE,eAAeL,IAEzDQ,EAAiBJ,YAAYD,GACH,MAAtBD,GACAM,EAAiBJ,YAAYvE,SAASwE,eAAeH,IAEzDN,EAAS5C,QAAQ0D,aAAaF,EAAkBV,GACzCF,EAASC,WCzDb,MAAMc,GAAb,cACI,KAAAC,SAA4B,KAC5B,KAAAnE,SAAqB,CACjBC,UAAW,EACXC,KAAM,EACNC,UAAW,GAEf,KAAAiE,SAAqB,GACrB,KAAA3C,eAAuC,IAS3C,MAAM,GAAQ,IAAiB,IAAIyC,GAG7B1C,GAAU,CACZxB,SAAWqE,GACAA,EAAMrE,SAGjB9C,SAAWmH,GACPA,EAAMD,SAASzL,OAAS,EAG5B2E,MAAQ+G,GACJA,EAAMD,SAASzL,QAAU,EAAI0L,EAAMD,SAAS,GAAK,GAGrD7G,OAAS8G,GACLA,EAAMD,SAASzL,QAAU,EAAI0L,EAAMD,SAAS,GAAK,GAGrDA,SAAWC,GACAA,EAAMD,SAGjB3C,eAAiB4C,GACNA,EAAM5C,gBAMf6C,GAAU,CACZ,aAAcC,EAAsBC,GAChC,OAAO,IAAIC,QAASC,IAChB,IAAIC,EAAS,IAAIC,WACjBD,EAAOE,OAAS,KACZ,IAAIC,EAAYH,EAAOnL,OACvB+K,EAAQxF,OAAO,eAAgB+F,EAAUC,MAAM,UAC/CR,EAAQxF,OAAO,WAAYyF,GAC3BE,KAEJC,EAAOK,WAAWR,EAAQ1C,KAAM0C,EAAQlD,aAGhD,mBAAoBiD,EAAsBC,GACtC,OAAO,IAAIC,QAAQ,CAACC,EAASO,KACzB,IAAIN,EAAS,IAAIC,WACjBD,EAAOE,OAAS,KACZ,IAAIC,EAAYH,EAAOnL,OACvB+K,EAAQxF,OAAO,eAAgB+F,EAAUC,MAAM,UAC/CL,KAE0B,MAA1BH,EAAQF,MAAMF,SACdQ,EAAOK,WAAWT,EAAQF,MAAMF,SAASrC,KAAM0C,GAE/CS,QAOVC,GAAY,CACd,aAAcb,EAAkBG,GAC5BH,EAAMD,SAAWI,EACjB,IAAIW,EAAQ,GACiB,GAAzBd,EAAMD,SAASzL,SACf0L,EAAM5C,eAAiB,IAO3B,IAHA,IAAI2D,EAAU,SACVC,EAAc,EAET5M,EAAI4M,EAAa5M,EAAI,KAAOA,EAAI4L,EAAMD,SAASzL,OAAQF,IAC5D,GAAI4L,EAAMD,SAAS3L,GAAGkG,MAAMyG,GAAU,CAClCC,EAAc5M,EACd,MAGR,IAAIkI,EAAS,EACT/B,EAAiB,EACrB,IAAKnG,EAAI4M,EAAc,EAAG5M,EAAI4L,EAAMD,SAASzL,OAAQF,IAAK,CAEtD,IAAIgF,EAAsB,CACtBkD,OAAQA,EACRhD,MAAOiB,EACP2B,QAAS,GACT7C,SAAU,gBACVoD,OAAQ,GAERP,EAAU8D,EAAMD,SAAS3L,GAE7B,GAAgB,KAAZ8H,EAAJ,CAQA,IAAI+E,EAAc,0BACdC,EAAYhF,EAAQ5B,MAAM2G,GAC9B,GAAIC,EAAW,CACX,IAAIC,EAAeC,OAAOC,aAAaH,EAAU,GAAGI,WAAW,GAAK,OAGpE,GAFAhF,EAAS9B,SAAS2G,GAEdD,EAAU,GACV,SAEA9H,EAAKkD,OAASA,EACdA,EAAS,EACTJ,EAAQ8B,QAAQiD,EAAa,IAGrC,IAAIM,EAAe,gBACfC,EAAQtF,EAAQ5B,MAAMiH,GACtBC,EACAlF,EAAS,GAKbJ,EAAUmC,EAAUnC,GACpBA,EAAU+B,EAAO/B,GACjBA,EAAUiC,EAAUjC,GACpBA,EAAUqC,EAAOrC,GACjBA,EAAU2B,EAAK3B,GAGX8D,EAAMrE,SAASC,YAAcxH,IAC7B8H,EAAU2C,GAAe3C,EAAS8D,EAAMrE,WAGxCO,IACA9C,EAAK8C,QAAUA,EACf4E,EAAMlM,KAAKwE,GACXmB,WA3CAnB,EAAKC,SAAW,gBAChByH,EAAMlM,KAAKwE,GACXmB,IA4CRyF,EAAM5C,eAAiB0D,GAG3B,YAAad,EAAkBG,GAC3B,IAAIsB,EAAgBzB,EAAM5C,eAAe+C,EAAQ7G,OAC5B,MAAjBmI,EACAA,EAAcvF,QAAUiE,EAAQjE,QAEhClC,QAAQC,IAAI,SAASkG,EAAQ7G,gDAIrC,eAAgB0G,GACZ,GAA8B,MAA1BA,EAAMrE,SAASO,QAAiB,CAChClC,QAAQC,IAAI,iCACZ+F,EAAM5C,eAAe4C,EAAMrE,SAASC,WAAWM,QAAU8D,EAAMrE,SAASO,QACxE,IAAIwF,EAAgB,CAAC9F,UAAU,EAAEC,KAAK,EAAEC,UAAU,EAAEI,QAAQ,MAC5D3H,OAAOoN,OAAO3B,EAAMrE,SAAS+F,QAE7B1H,QAAQC,IAAI,2BAIpB,aAAc+F,EAAkBrE,GAC5B,GAA8B,MAA1BqE,EAAMrE,SAASO,QAAnB,CACIlC,QAAQC,IAAI,+BACZ,IAAI2H,EAAqB5B,EAAM5C,eAAezB,EAASC,WACvD,GAA0B,MAAtBgG,EAAJ,CAIA,IAAIC,EAAeD,EAAmB1F,QACtC0F,EAAmB1F,QAAU2C,GAAegD,EAAclG,GAC1D3B,QAAQC,IAAI,qCACZD,QAAQC,IAAI4H,GACZlG,EAASO,QAAU2F,EACnBtN,OAAOoN,OAAO3B,EAAMrE,SAAUA,QAR1B3B,QAAQC,IAAI,uBAAuB0B,EAASC,+BAUhD5B,QAAQC,IAAI,2DAKpB,SAAU+F,EAAkBG,GACxBH,EAAMF,SAAWK,IAIV,QACb2B,YAAY,EACZ9B,MAAK,GACLC,WACA9C,WACA0D,cC/NF,OAAIkB,IAAI,QAER,MAAMC,IAAQ,EAEC,WAAI,OAAKC,MAAM,CAC5BpN,QAAS,CACLqN,SAEJC,OAAQH,KCPV,OAAII,OAAOC,eAAgB,EAC3B,OAAIN,IAAI,QAER,IAAI,OAAI,CACNO,SACA3K,OAAQ,SAAU4K,GAAK,OAAOA,EAAEC,MAC/BC,OAAO,S","file":"js/app.417ba5ba.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TheBook.vue?vue&type=style&index=0&id=2422fa96&scoped=true&lang=css&\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropScreen.vue?vue&type=style&index=0&id=7fe24628&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BookBookmark.vue?vue&type=style&index=0&id=ed1f001c&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BookParagraph.vue?vue&type=style&index=0&id=4830f37f&scoped=true&lang=css&\"","var render, staticRenderFns\nimport script from \"./BookHeader.vue?vue&type=script&lang=js&\"\nexport * from \"./BookHeader.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('DropScreen',{tag:\"component\"})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"drop-wrapper\",on:{\"dragover\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onFileDragover($event)},\"dragleage\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onFileDragleave($event)},\"drop\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onFileDrop($event)}}},[_c('div',{staticClass:\"welcome-wrapper\"},[(!_vm.isLoaded)?_c('h1',{staticClass:\"welcome\"},[_vm._v(\"Drag and drop unzipped Aozora Bunko text file\")]):_vm._e()]),(_vm.isLoaded)?_c('TheBook'):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"the-book-wrapper\"},[_c('div',{staticClass:\"the-book\"},[_c('BookBookmark'),_c('h1',[_vm._v(_vm._s(_vm.title))]),_c('h2',[_vm._v(_vm._s(_vm.author))]),_vm._l((_vm.textComponents),function(text){return _c(text.textType,{key:text.index,tag:\"component\",attrs:{\"id\":text.textType + '-' + text.index,\"text\":text}})})],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"bookmark-indicator\",style:(_vm.bookmarkStyle)})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\r\nimport Vue from 'vue'\r\n//import { BOOKMARK_CLASS } from '../helpers/bookmark'\r\n\r\nexport default Vue.extend({\r\n    name: 'BookBookmark',\r\n    \r\n    data() {\r\n        return {\r\n            pxPosition: 0,\r\n        }\r\n    },\r\n\r\n    computed: {\r\n        bookmarkStyle() :Partial<CSSStyleDeclaration> {\r\n            return {\r\n                left: this.pxPosition + 'px',\r\n            }\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        window.addEventListener('click', (e) => {\r\n            var target = e.target as HTMLElement\r\n            if (target == null || target.id == null) {\r\n                console.log('Invalid target. Logging event for debugging')\r\n                console.log(e)\r\n                return \r\n            }\r\n            if (!target.classList.contains('paragraph')) {\r\n                // can only bookmark when clicking on the text. Todo, get nearest paragraph of click\r\n                return\r\n            }\r\n            if (!target.id.startsWith('BookParagraph')) {\r\n                // TODO: try bubbling up before just exiting, could have clicked on a child node\r\n                // https://github.com/shousetsubook/shousetsubook.github.io/blob/50bd35b2abbecb2e82c766088082a88d3450bc07/src/components/BookBookmark.vue#L105\r\n                console.log(\"didn't click on what we expected. Logging target for debug info\")\r\n                console.log(target)\r\n                return\r\n            }\r\n            var paragraphIndexMatch = target.id.match(/(\\d+)/);\r\n            if (paragraphIndexMatch == null) {\r\n                console.log(\"couldn't get paragraph index from id. Logging target for debug info\")\r\n                console.log(target)\r\n                return\r\n            }\r\n            var paragraphIndex = parseInt(paragraphIndexMatch[0]);\r\n\r\n            // TODO remove old bookmark, if it exists\r\n            this.$store.commit('book/removeBookmark');\r\n            this.$nextTick(function() {\r\n                var range: Range | CaretPosition;\r\n                var offset: number;\r\n                var textNode: Node;\r\n                if (document.caretPositionFromPoint) {    // Firefox\r\n                    range = document.caretPositionFromPoint(e.x,e.y) as CaretPosition;\r\n                    textNode = range.offsetNode;\r\n                    offset = range.offset;\r\n                } else if (document.caretRangeFromPoint) {     // Chromium-based\r\n                    range = document.caretRangeFromPoint(e.x,e.y) as Range;\r\n                    textNode = range.startContainer;\r\n                    offset = range.startOffset;\r\n                } else {\r\n                    console.log('unsupported browser')\r\n                    return\r\n                }\r\n                var nodeIndex: number = Array.prototype.indexOf.call(target.childNodes, textNode);\r\n                var bookmark = {\r\n                    paragraph: paragraphIndex,\r\n                    node: nodeIndex,\r\n                    character: offset,\r\n                }\r\n                this.$store.commit('book/loadBookmark', bookmark);\r\n            })\r\n        })\r\n    }\r\n\r\n    \r\n});\r\n\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--13-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BookBookmark.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--13-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BookBookmark.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./BookBookmark.vue?vue&type=template&id=ed1f001c&scoped=true&\"\nimport script from \"./BookBookmark.vue?vue&type=script&lang=ts&\"\nexport * from \"./BookBookmark.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./BookBookmark.vue?vue&type=style&index=0&id=ed1f001c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ed1f001c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"paragraph text-component\",style:(_vm.jisageStyle),attrs:{\"id\":_vm.paragraphId},domProps:{\"innerHTML\":_vm._s(_vm.text.content)}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div\r\n        v-bind:id=\"paragraphId\"\r\n        v-html=\"text.content\"\r\n        v-bind:style=\"jisageStyle\"\r\n        class=\"paragraph text-component\"\r\n    ></div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nexport default Vue.extend({\r\n    name: 'BookParagraph',\r\n    props: ['text'],\r\n    data: function () {\r\n        return {\r\n            paragraphId: this.text.index + '-paragraph',\r\n            jisageStyle: {\r\n                margin: this.text.jisage + \"em 0 0 0\"\r\n            }\r\n        }\r\n    }\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n    .paragraph {\r\n        text-align:justify;\r\n        word-wrap:break-word;\r\n        background-color:rgb(241, 237, 212);\r\n    }\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BookParagraph.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BookParagraph.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BookParagraph.vue?vue&type=template&id=4830f37f&scoped=true&\"\nimport script from \"./BookParagraph.vue?vue&type=script&lang=js&\"\nexport * from \"./BookParagraph.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BookParagraph.vue?vue&type=style&index=0&id=4830f37f&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4830f37f\",\n  null\n  \n)\n\nexport default component.exports","<script>\r\nimport Vue from 'vue'\r\nexport default Vue.extend({\r\n        props: ['text'],\r\n        data: function() {\r\n            return {\r\n                headerId: \"header-\" + this.text.index,\r\n            }\r\n        },\r\n        render: function(createElement) {\r\n            return createElement(\r\n                'h' + this.text.hLevel,\r\n                {\r\n                    class: {\r\n                        'header': true,\r\n                        'text-component': true,\r\n                    },\r\n                    style: {\r\n                        margin: this.text.jisage + \"em 0 0 0\",\r\n                    },\r\n                    key: this.text.index,\r\n                },\r\n                this.text.content,\r\n            )\r\n        },\r\n});\r\n</script>\r\n    });\r\n    <style>\r\n    </style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BookHeader.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BookHeader.vue?vue&type=script&lang=js&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('br')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <br>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nexport default Vue.extend({\r\n    name: 'BookLineBreak',\r\n    props: [\"text\"],\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BookLineBreak.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BookLineBreak.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BookLineBreak.vue?vue&type=template&id=f9e0cc8e&scoped=true&\"\nimport script from \"./BookLineBreak.vue?vue&type=script&lang=js&\"\nexport * from \"./BookLineBreak.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f9e0cc8e\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport BookBookmark from './BookBookmark.vue'\r\nimport BookParagraph from './BookParagraph.vue'\r\nimport BookHeader from './BookHeader.vue'\r\nimport BookLineBreak from './BookLineBreak.vue'\r\nimport Vue from 'vue'\r\nexport default Vue.extend({\r\n    name: 'TheBook',\r\n\r\n    components: {\r\n        BookBookmark: BookBookmark,\r\n        BookParagraph: BookParagraph,\r\n        BookHeader: BookHeader,\r\n        BookLineBreak: BookLineBreak,\r\n    },\r\n\r\n    data: function() {\r\n        return {\r\n            position: 0,\r\n            encoding: 'shift-jis',\r\n        }\r\n    },\r\n\r\n    methods: {\r\n    },\r\n\r\n    computed: {\r\n        isLoaded: function() {\r\n            return this.$store.getters['book/isLoaded']\r\n        },\r\n        title: function () {\r\n            return this.$store.getters['book/title']\r\n        },\r\n        author: function() {\r\n            return this.$store.getters['book/author']\r\n        },\r\n        textComponents: function() {\r\n            return this.$store.getters['book/textComponents']\r\n        },\r\n    },\r\n\r\n});\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--13-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TheBook.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--13-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TheBook.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TheBook.vue?vue&type=template&id=2422fa96&scoped=true&\"\nimport script from \"./TheBook.vue?vue&type=script&lang=ts&\"\nexport * from \"./TheBook.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./TheBook.vue?vue&type=style&index=0&id=2422fa96&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2422fa96\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport TheBook from './TheBook.vue'\r\nimport Vue from 'vue'\r\nexport default Vue.extend({\r\n    name: 'DropScreen',\r\n    components: {\r\n        TheBook\r\n    },\r\n\r\n    data() {\r\n        return {\r\n            isDraggingFile: false,\r\n        }\r\n    },\r\n\r\n    computed: {\r\n        isLoaded() { return this.$store.getters['book/isLoaded']},\r\n    },\r\n\r\n    methods: {\r\n        onFileDragover() {\r\n            this.isDraggingFile = true;\r\n        },\r\n        onFileDragleave() {\r\n            this.isDraggingFile = false;\r\n        },\r\n        onFileDrop(e :DragEvent) {\r\n            this.isDraggingFile = false;\r\n            if (e.dataTransfer) {\r\n                for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                    var file = e.dataTransfer.files[i];\r\n                    this.$store.dispatch({\r\n                        type: 'book/loadFromFile',\r\n                        file: file,\r\n                        encoding: 'shift-jis',\r\n                    })\r\n                }\r\n            }\r\n        },\r\n    }\r\n});\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--13-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropScreen.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--13-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DropScreen.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./DropScreen.vue?vue&type=template&id=7fe24628&scoped=true&\"\nimport script from \"./DropScreen.vue?vue&type=script&lang=ts&\"\nexport * from \"./DropScreen.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./DropScreen.vue?vue&type=style&index=0&id=7fe24628&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7fe24628\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <component :is=\"'DropScreen'\"/>\n  </div>\n</template>\n\n<script>\nimport DropScreen from './components/DropScreen.vue'\n\nexport default {\n  name: 'App',\n  components: {\n    DropScreen,\n  }\n}\n</script>\n\n<style>\nhtml, body, #app {\n  background-color:rgb(241, 237, 212);\n  height: 100%;\n  width: 100%;\n  padding: 0;\n  margin: 0;\n  position:absolute;\n}\n\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=62a5a4a2&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","const todo = function(text :string) {\r\n    // TODO: these are the other formatting options that I haven't implemented yet, but just remove for now\r\n    var comments = /［＃.+?］/g\r\n    var accents = /[〔〕]/g\r\n    text = text.replace(comments, \"\")\r\n    text = text.replace(accents, \"\")\r\n    return text\r\n}\r\nconst rubify = function(text :string) {\r\n    // hiragana katakana fw-roman hw-katakana unicodes:\r\n    // \\u3040-\\u309f\\u30a0-\\u30ff\\uff00-\\uff9f\r\n    //｜ is the kanji separator (different from ascii pipe |)\r\n    var furigana = /｜?([々\\u4e00-\\u9faf\\u3400-\\u4dbf]+?)《(.+?)》/g;\r\n    return text.replace(furigana, '<ruby>$1<rt>$2</rt></ruby>');\r\n}\r\nconst boutenify = function(text :string) {\r\n    var bouten = /(.+?)［＃「\\1」に傍点］/g;\r\n    return text.replace(bouten, '<span class=\"sesame-vertical\">$1</span>')\r\n}\r\nconst kutenkara = function(text :string) {\r\n    // TODO: actually convert the jis kuten codes\r\n    // TODO: non-kanji and unicode\r\n    var jiskuten = /※［＃(?:「(.+?)」、)?第(\\d+?)水準(\\d+?)-(\\d+?)-(\\d+?)］/g\r\n    return text.replace(jiskuten, \"※\")\r\n}\r\nconst midasi = function(text :string) {\r\n    var midasipattern = /(.+?)［＃「\\1」は([大中小])見出し］/g\r\n    return text.replace(midasipattern, function(match, p1, p2) {\r\n        switch(p2) {\r\n            case \"大\":\r\n                return '<h1>' + p1 + '</h1>';\r\n            case \"中\":\r\n                return '<h2>' + p1 + '</h2>';\r\n            case \"小\":\r\n                return '<h3>' + p1 + '</h3>';\r\n        }\r\n        console.log('Error replacing midasi pattern. Text: ' + text)\r\n        return ''\r\n    })\r\n}\r\nexport {\r\n    todo,\r\n    rubify,\r\n    midasi,\r\n    kutenkara,\r\n    boutenify,\r\n}\r\n","interface Bookmark {\r\n    paragraph: number,\r\n    node: number,\r\n    character: number,\r\n    content?: string,\r\n}\r\n\r\nconst BOOKMARK_CLASS = 'bookmark'\r\n\r\nconst idFromBookmark = (bookmark :Bookmark) :string => {\r\n    return `p${bookmark.paragraph}n${bookmark.node}c${bookmark.character}`;\r\n}\r\n\r\nconst removeBookmark = (content :string) :string => {\r\n    // create a Template to parse easily\r\n    var template = document.createElement('template');\r\n    template.innerHTML = content;\r\n\r\n    // todo: multiple bookmarking\r\n    var span = template.content.querySelector(`.${BOOKMARK_CLASS}`);\r\n    if (span) {\r\n        var spanContents = document.createTextNode(span.innerHTML);\r\n        template.content.replaceChild(spanContents,span);\r\n        // the inner nodes will still be fragmented so this should combine them\r\n        var temp = template.innerHTML;\r\n        template.innerHTML = temp;\r\n        console.log(template);\r\n        return template.innerHTML;\r\n    } else {\r\n        console.log(\"Couldn't remove bookmark\")\r\n        return content;\r\n    }\r\n\r\n}\r\n\r\nconst insertBookmark = (content :string, bookmark: Bookmark) :string => {\r\n    // create a Template to parse easily\r\n    var template = document.createElement('template');\r\n    template.innerHTML = content;\r\n\r\n    // get the textNode that bookmark points to\r\n    var bookmarkNode = template.content.childNodes[bookmark.node];\r\n    if (bookmarkNode == null || bookmarkNode.textContent == null) {\r\n        console.log(`Invalid bookmark. Node with index ${bookmark.node} does not exist`);\r\n        return content;\r\n    }\r\n\r\n    // slice the node to get the specific chracter that bookmark points to\r\n    var sliceUntilBookmark = bookmarkNode.textContent.slice(0, bookmark.character);\r\n    var charAtBookmark = bookmarkNode.textContent[bookmark.character];\r\n    var sliceAfterBookmark = bookmarkNode.textContent.slice(bookmark.character+1);\r\n\r\n    if (charAtBookmark == null) {\r\n        console.log(`Invalid bookmark. Character with index ${bookmark.character} does not exist`);\r\n        return content;\r\n    }\r\n\r\n    var newBookmark = document.createElement('span') as HTMLElement;\r\n    newBookmark.appendChild(document.createTextNode(charAtBookmark));\r\n    // TODO: we can't rely on these being set if this function fails, but we're going to just assume it for now because it's easier.\r\n    newBookmark.id = idFromBookmark(bookmark);\r\n    newBookmark.classList.add(BOOKMARK_CLASS);\r\n    newBookmark.style.backgroundColor = \"red\";\r\n\r\n    // repiece the nodes together\r\n    var bookmarkFragment = document.createDocumentFragment();\r\n    if (sliceUntilBookmark != null) {\r\n        bookmarkFragment.appendChild(document.createTextNode(sliceUntilBookmark));\r\n    }\r\n    bookmarkFragment.appendChild(newBookmark);\r\n    if (sliceAfterBookmark != null) {\r\n        bookmarkFragment.appendChild(document.createTextNode(sliceAfterBookmark));\r\n    }\r\n    template.content.replaceChild(bookmarkFragment, bookmarkNode);\r\n    return template.innerHTML;\r\n}\r\n\r\nexport {\r\n    BOOKMARK_CLASS,\r\n    Bookmark,\r\n    insertBookmark,\r\n    idFromBookmark,\r\n    removeBookmark,\r\n}","import { todo, rubify, midasi, boutenify, kutenkara } from '../helpers/aozora'\r\nimport { Bookmark, insertBookmark } from '../helpers/bookmark'\r\n\r\nexport interface TextComponent {\r\n    jisage: number,\r\n    index: number,\r\n    hLevel: number,\r\n    content: string\r\n    textType: string,\r\n}\r\n\r\ninterface BookContext {\r\n    commit: Function\r\n    state: BookState\r\n    dispatch: Function\r\n}\r\n\r\nexport class BookState {\r\n    bookFile: BookFile | null = null;\r\n    bookmark: Bookmark = {\r\n        paragraph: 0,\r\n        node: 0,\r\n        character: 0,\r\n    };\r\n    rawLines: string[] = [];\r\n    textComponents: Array<TextComponent> = [];\r\n}\r\n\r\n\r\nexport interface BookFile {\r\n    file: File,\r\n    encoding: string,\r\n}\r\n\r\nconst state = () :BookState => new BookState();\r\n\r\n// getters\r\nconst getters = {\r\n    bookmark: (state :BookState) :Bookmark => {\r\n        return state.bookmark\r\n    },\r\n\r\n    isLoaded: (state :BookState) :boolean => (\r\n        state.rawLines.length > 0\r\n    ),\r\n\r\n    title: (state :BookState) :string => (\r\n        state.rawLines.length >= 2 ? state.rawLines[0] : ''\r\n    ),\r\n\r\n    author: (state :BookState) :string => (\r\n        state.rawLines.length >= 2 ? state.rawLines[1] : ''\r\n    ),\r\n\r\n    rawLines: (state :BookState) :Array<string> => {\r\n        return state.rawLines;\r\n    },\r\n\r\n    textComponents: (state :BookState) :Array<TextComponent> => {\r\n        return state.textComponents;\r\n    }\r\n}\r\n\r\n\r\n// actions\r\nconst actions = {\r\n    loadFromFile (context :BookContext, payload :BookFile) {\r\n        return new Promise((resolve) => {\r\n            var reader = new FileReader();\r\n            reader.onload = () => {\r\n                var rawString = reader.result as string;\r\n                context.commit('loadRawLines', rawString.split(/\\r?\\n/))\r\n                context.commit('loadFile', payload)\r\n                resolve();\r\n            };\r\n            reader.readAsText(payload.file, payload.encoding);\r\n        });\r\n    },\r\n    reloadWithEncoding (context :BookContext, payload :string) {\r\n        return new Promise((resolve, reject) => {\r\n            var reader = new FileReader();\r\n            reader.onload = () => {\r\n                var rawString = reader.result as string;\r\n                context.commit('loadRawLines', rawString.split(/\\r?\\n/))\r\n                resolve();\r\n            };\r\n            if (context.state.bookFile != null) {\r\n                reader.readAsText(context.state.bookFile.file, payload);\r\n            } else {\r\n                reject();\r\n            }\r\n        });\r\n    },\r\n}\r\n\r\n// mutations\r\nconst mutations = {\r\n    loadRawLines (state :BookState, payload :Array<string>) {\r\n        state.rawLines = payload\r\n        var texts = [];\r\n        if (state.rawLines.length == 0) {\r\n            state.textComponents = [];\r\n        }\r\n\r\n        // metadata\r\n        var divisor = /^-----/;\r\n        var metadataEnd = 4;\r\n        // arbitrarily stop at 100 (or EOF). If we hit 100, something is wrong so just include the metadata\r\n        for (var i = metadataEnd; i < 100 && i < state.rawLines.length; i++) {\r\n            if (state.rawLines[i].match(divisor)) {\r\n                metadataEnd = i\r\n                break\r\n            }\r\n        }\r\n        var jisage = 0;\r\n        var paragraphIndex = 0;\r\n        for (i = metadataEnd + 1; i < state.rawLines.length; i++) {\r\n            // the text props we will pass to the BookParagraph component\r\n            var text :TextComponent = {\r\n                jisage: jisage,\r\n                index: paragraphIndex,\r\n                content: \"\",\r\n                textType: 'BookParagraph',\r\n                hLevel: 0,\r\n            }\r\n            var content = state.rawLines[i]\r\n            // line break\r\n            if (content === \"\") {\r\n                text.textType = 'BookLineBreak';\r\n                texts.push(text);\r\n                paragraphIndex++;\r\n                continue;\r\n            }\r\n\r\n            // first, check if it's a formatting line\r\n            var sagepattern = /^［＃(ここから)?([０-９]+?)字下げ］/\r\n            var fullwidth = content.match(sagepattern)\r\n            if (fullwidth) {\r\n                var jisageString = String.fromCharCode(fullwidth[2].charCodeAt(0) - 0xFEE0)\r\n                jisage = parseInt(jisageString)\r\n                // if ここから then continue, else change jisage for the current line\r\n                if (fullwidth[1]) {\r\n                    continue\r\n                } else {\r\n                    text.jisage = jisage\r\n                    jisage = 0\r\n                    content.replace(sagepattern, \"\")\r\n                }\r\n            }\r\n            var owaripattern = /^［＃ここで字下げ終わり］/\r\n            var owari = content.match(owaripattern)\r\n            if (owari) {\r\n                jisage = 0\r\n                continue\r\n            }\r\n\r\n            // next, do things like simple search and replace\r\n            content = kutenkara(content)\r\n            content = rubify(content)\r\n            content = boutenify(content)\r\n            content = midasi(content)\r\n            content = todo(content)\r\n\r\n            // add bookmark if available\r\n            if (state.bookmark.paragraph === i) {\r\n                content = insertBookmark(content, state.bookmark);\r\n            }\r\n\r\n            if (content) {\r\n                text.content = content\r\n                texts.push(text);\r\n                paragraphIndex++;\r\n            }\r\n        }\r\n        state.textComponents = texts;\r\n    },\r\n\r\n    loadContent (state :BookState, payload :{index:number, content:string}) {\r\n        var textComponent = state.textComponents[payload.index];\r\n        if (textComponent != null) {\r\n            textComponent.content = payload.content;\r\n        } else {\r\n            console.log(`index ${payload.index} out of range for state.textComponents`)\r\n        }\r\n    },\r\n\r\n    removeBookmark (state :BookState) {\r\n        if (state.bookmark.content != null) {\r\n            console.log(\"Attempting to remove bookmark\");\r\n            state.textComponents[state.bookmark.paragraph].content = state.bookmark.content;\r\n            let emptyBookmark = {paragraph:0,node:0,character:0,content:null};\r\n            Object.assign(state.bookmark,emptyBookmark)\r\n        } else {\r\n            console.log(\"Bookmark doesn't exist\");\r\n        }\r\n    },\r\n\r\n    loadBookmark (state :BookState, bookmark :Bookmark) {\r\n        if (state.bookmark.content == null) {\r\n            console.log(\"First time loading bookmark\")\r\n            var cleanTextComponent = state.textComponents[bookmark.paragraph]\r\n            if (cleanTextComponent == null) {\r\n                console.log(`Bookmark paragraph  ${bookmark.paragraph} out of range`)\r\n                return\r\n            }\r\n            var cleanContent = cleanTextComponent.content;\r\n            cleanTextComponent.content = insertBookmark(cleanContent, bookmark);\r\n            console.log(\"Going to set bookmark content to:\")\r\n            console.log(cleanContent)\r\n            bookmark.content = cleanContent;\r\n            Object.assign(state.bookmark, bookmark);\r\n        } else {\r\n            console.log(\"Error, bookmark already loaded. Please remove it first\")\r\n            return;\r\n        }\r\n    },\r\n\r\n    loadFile (state :BookState, payload :BookFile) {\r\n        state.bookFile = payload ;\r\n    },\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  actions,\r\n  getters,\r\n  mutations\r\n}","import Vue from 'vue'\r\nimport Vuex from 'vuex'\r\nimport book from './book'\r\n\r\nVue.use(Vuex)\r\n\r\nconst debug = process.env.NODE_ENV !== 'production'\r\n\r\nexport default new Vuex.Store({\r\n  modules: {\r\n      book,\r\n  },\r\n  strict: debug,\r\n})\r\n","import Vue from 'vue'\nimport Vuex from 'vuex'\nimport App from './App.vue'\nimport store from './store'\n\nVue.config.productionTip = false;\nVue.use(Vuex);\n\nnew Vue({\n  store,\n  render: function (h) { return h(App) },\n}).$mount('#app');"],"sourceRoot":""}